<html>
<head>
<title>sql.open</title>
<link rel="stylesheet" href="../macros.css">
</head>
<body>
<h1 id="sql.open">SQL.OPEN macro</h1>
<p>Establishes a connection with a data source. If the connection is successfully established SQL.OPEN will return a connection ID number. Use the connection ID number with other ODBC macro functions to identify a connection.</p>
<p>If this function is not available, you must install the Microsoft ODBC add-in (XLODBC.XLA).</p>
<p><strong>Syntax</strong></p>
<p><strong>SQL.OPEN</strong>(<strong>connection_string</strong>, output_ref, driver_prompt)</p>
<p>Connection_string    is a text string that contains the information necessary to establish a connection to a data source. Any data-source-name that is used in connection_string must be an existing data source name defined with ODBC Setup or the ODBC Administration Utility.</p>
<ul>
<li><blockquote>
<p>Connection_string must follow the format described in Chapter 24, "ODBC Function Reference", of the Microsoft Open Database Connectivity Programmer's Reference for SQLDriverConnect. In this string the user supplies the data source name, one or more user ID's, one or more passwords, and any other information necessary to successfully connect to a DBMS. An example of a SQL.OPEN connection_string entered would be: "DSN=MyServer; UID=dbayer; PWD=123; Database=pubs"</p>
</blockquote></li>
<li><blockquote>
<p>Enter the connection_string as an array when the length exceeds 255 characters. Or enter connection_string as an array of cells containing the same information. The connection string should be horizontal array.</p>
</blockquote></li>
</ul>
<p>Output_ref    is a single cell reference where you want the completed connection string to be placed. Use output_ref when you want SQL.OPEN to return the completed connection string. If output_ref is omitted, a completed connection string will not be returned.</p>
<p>Driver_prompt     is a number from 1 to 4 specifying if and how you want to be prompted by the driver. This sets the fDriverCompletion flag in ODBC's SQLDriverConnect.</p>
<table>
<tbody>
<tr class="odd">
<td><blockquote>
<p><strong>Number</strong></p>
</blockquote></td>
<td><blockquote>
<p><strong>Description</strong></p>
</blockquote></td>
</tr>
<tr class="even">
<td><blockquote>
<p>1</p>
</blockquote></td>
<td><blockquote>
<p>Always brings up a dialog box.</p>
</blockquote></td>
</tr>
<tr class="odd">
<td><blockquote>
<p>2</p>
</blockquote></td>
<td><blockquote>
<p>Bring up dialog only if there is not enough information to connect. The driver uses information from the connection string and from the data source specification as defaults.</p>
</blockquote></td>
</tr>
<tr class="even">
<td><blockquote>
<p>3</p>
</blockquote></td>
<td><blockquote>
<p>Same as 2, but the driver grays and disables any prompts for information not needed.</p>
</blockquote></td>
</tr>
<tr class="odd">
<td><blockquote>
<p>4</p>
</blockquote></td>
<td><blockquote>
<p>If the connection string is unsuccessful, do not bring up a dialog box.</p>
</blockquote></td>
</tr>
</tbody>
</table>
<p><strong>Remarks</strong></p>
<ul>
<li><blockquote>
<p>If SQL.OPEN is unable to connect with the information provided then it will return the error value #N/A. In such a case, SQL.OPEN will place error information in memory for the SQL.ERROR function, if more information is available.</p>
</blockquote></li>
<li><blockquote>
<p>If the call is successful then SQL.OPEN will return a unique connection ID number that can be used in future function calls to identify the connection.</p>
</blockquote></li>
<li><blockquote>
<p>If connection_array does not allow SQL.OPEN to connect to a data source, then the error value #N/A will be returned.</p>
</blockquote></li>
</ul>
<p><strong>Example</strong></p>
<p>conn1=SQL.OPEN('DSN=NWind;DBQ=C:\MSQUERY;FIL=dBASE4',C15, 2) sets the name conn1 to the return value of SQL.OPEN, which connects to the NWind data source, specifies where to place the connection string, and displays the driver dialog box only if additional information is needed.</p>
<p><strong>Related Functions</strong></p>
<p><a href="sql.exec.query.html">SQL.EXEC.QUERY</a>   Sends a query to a data source</p><p><a href="sql.bind.html">SQL.BIND</a>   Specifies storage for a result column</p><p><a href="sql.retrieve.to.file.html">SQL.RETRIEVE.TO.FILE</a>   Retrieves query results and places them in a file</p><p><a href="sql.retrieve.html">SQL.RETRIEVE</a>   Retrieves query results</p><p><a href="sql.get.schema.html">SQL.GET.SCHEMA</a>   Gets information about a connected data source.</p><p><a href="sql.close.html">SQL.CLOSE</a>   Closes a data source connection</p><p><a href="sql.error.html">SQL.ERROR</a>   Returns detailed error information</p>
</body>
</html>
