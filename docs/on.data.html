<html>
<head>
<title>on.data</title>
<link rel="stylesheet" type="text/css" href="macros.css"/>
</head>
<body>
<h1 id="on.data">ON.DATA macro</h1>
<p>Runs a specified macro when another application sends data to a particular workbook via dynamic data exchange (DDE) or via Publish and Subscribe on the Macintosh. Workbook links to other applications are called remote references.</p>
<p><strong>Syntax</strong></p>
<p><strong>ON.DATA</strong>(document_text, macro_text)</p>
<p><strong>Important</strong>   Microsoft Excel for the Macintosh requires system software version 7.0 or later for this function.</p>
<p>Document_text    is the name of the sheet to which remote data will be sent or the name of the source of the remote data.</p>
<ul>
<li><blockquote>
<p>If document_text is the name of the remote data source, it must be in the form app|topic!item. You can use the form app|topic to include all items for a particular topic, or app| to specify an app alone, but you must include the | to indicate that you are specifying the name of a data source.</p>
</blockquote></li>
<li><blockquote>
<p>If document_text is omitted, the macro specified by macro_text is run whenever remote data is sent to any sheet not already assigned to another ON.DATA function.</p>
</blockquote></li>
<li><blockquote>
<p>In Microsoft Excel for the Macintosh, document_text can also be the name of a published edition file. Unless the file is in the current folder, document_text must include the complete path.</p>
</blockquote></li>
</ul>
<blockquote>
<p> </p>
</blockquote>
<p>Macro_text    is the name of, or an R1C1-style reference to, a macro that you want to run when data comes into the workbook or from the source specified by document_text. The name or reference must be in text form.</p>
<ul>
<li><blockquote>
<p>If macro_text is omitted, the ON.DATA function is turned off for the specified workbook or source.</p>
</blockquote></li>
</ul>
<blockquote>
<p> </p>
</blockquote>
<p><strong>Remarks</strong></p>
<ul>
<li><blockquote>
<p>ON.DATA remains in effect until you either clear it or quit Microsoft Excel. You can clear ON.DATA by specifying document_text and omitting the macro_text argument.</p>
</blockquote></li>
<li><blockquote>
<p>If the macro sheet containing macro_text is closed when data is sent to document_text, an error is returned.</p>
</blockquote></li>
<li><blockquote>
<p>If the incoming data causes recalculation, Microsoft Excel first runs the macro macro_text and then performs the recalculation.</p>
</blockquote></li>
</ul>
<blockquote>
<p> </p>
</blockquote>
<p><strong>Examples</strong></p>
<p>In Microsoft Excel for Windows, the following macro formula runs the macro AddOrders when data is sent to the sheet New in the workbook ORDERSDB.XLS:</p>
<p>ON.DATA("[ORDERSDB.XLS]New", "AddOrders")</p>
<p>In Microsoft Excel for the Macintosh, the following macro formula runs the macro beginning at cell R2C3 when data is sent to the sheet North in the workbook SALES DATABASE:</p>
<p>ON.DATA("[SALES DATABASE]North", "R2C3")</p>
<p><strong>Related Functions</strong></p>
<p><a href="error.html">ERROR</a>   Specifies what action to take if an error is encountered while a macro is running</p><p><a href="initiate.html">INITIATE</a>   Opens a channel to another application</p><p><a href="on.entry.html">ON.ENTRY</a>   Runs a macro when data is entered</p><p><a href="on.recalc.html">ON.RECALC</a>   Runs a macro when a workbook is recalculated</p>
</body>
</html>
