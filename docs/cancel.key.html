<html>
<head>
<title>cancel.key</title>
<link rel="stylesheet" type="text/css" href="macros.css"/>
</head>
<body>
<h1 id="cancel.key">CANCEL.KEY macro</h1>
<p>Disables macro interruption, or specifies a macro to run when a macro is interrupted. Use CANCEL.KEY to control what happens when a macro is interrupted.</p>
<p><strong>Syntax</strong></p>
<p><strong>CANCEL.KEY</strong>(<strong>enable</strong>, macro_ref)</p>
<p>Enable    specifies whether the macro can be interrupted by pressing ESC in Microsoft Excel for Windows or ESC or COMMAND+PERIOD in Microsoft Excel for the Macintosh.</p>
<table>
<tbody>
<tr class="odd">
<td><strong>If enable is</strong></td>
<td><strong>Then</strong></td>
</tr>
<tr class="even">
<td>FALSE</td>
<td>Pressing ESC or COMMAND+PERIOD does not interrupt a macro</td>
</tr>
<tr class="odd">
<td>TRUE and macro_ref is omitted</td>
<td>Pressing ESC or COMMAND+PERIOD interrupts a macro</td>
</tr>
<tr class="even">
<td>TRUE and macro_ref is specified</td>
<td>Macro_ref runs when ESC or COMMAND+PERIOD is pressed</td>
</tr>
</tbody>
</table>
<p>Macro_ref    is a reference to a macro, as a cell reference or a name, that runs when enable is TRUE and ESC or COMMAND+PERIOD is pressed.</p>
<p><strong>Remarks</strong></p>
<ul>
<li><blockquote>
<p>CANCEL.KEY affects only the macro that is currently running. Once the macro is stopped by a RETURN or HALT function, ESC or COMMAND+PERIOD is reactivated.</p>
</blockquote></li>
<li><blockquote>
<p>When CANCEL.KEY is in effect, users can still cancel a dialog box displayed while the macro is running.</p>
</blockquote></li>
</ul>
<blockquote>
<p> </p>
</blockquote>
<p><strong>Examples</strong></p>
<p>The following macro formula prevents the macro from being interrupted by pressing ESC or COMMAND+PERIOD:</p>
<p>CANCEL.KEY(FALSE)</p>
<p>The following macro formula reactivates ESC or COMMAND+PERIOD to cancel macro execution:</p>
<p>CANCEL.KEY(TRUE)</p>
<p>The following line in a macro runs CheckCancel when ESC or COMMAND+PERIOD is pressed:</p>
<p>CANCEL.KEY(TRUE, CheckCancel)</p>
<p><strong>Related Functions</strong></p>
<p><a href="error.html">ERROR</a>   Specifies an action to take if an error occurs while a macro is running</p><p><a href="on.key.html">ON.KEY</a>   Runs a macro when a specified key is pressed</p><p><a href="on.time.html">ON.TIME</a>   Runs a macro at a specified time</p>
</body>
</html>
