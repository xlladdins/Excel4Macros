<html>
<head>
<title>for</title>
<link rel="stylesheet" href="../macros.css">
</head>
<body>
<h1 id="for">FOR macro</h1>
<p>Starts a FOR-NEXT loop. The instructions between FOR and NEXT are repeated until the loop counter reaches a specified value. Use FOR when you need to repeat instructions a specified number of times. Use FOR.CELL when you need to repeat instructions over a range of cells.</p>
<p><strong>Syntax</strong></p>
<p><strong>FOR</strong>(<strong>counter_text, start_num, end_num</strong>, step_num)</p>
<p>Counter_text    is the name of the loop counter in the form of text.</p>
<p>Start_num    is the value initially assigned to counter_text.</p>
<p>End_num    is the last value assigned to counter_text.</p>
<p>Step_num    is a value added to the loop counter after each iteration. If step_num is omitted, it is assumed to be 1.</p>
<p><strong>Remarks</strong></p>
<ul>
<li><blockquote>
<p>Microsoft Excel follows these steps as it executes a FOR-NEXT loop:</p>
</blockquote></li>
</ul>
<table>
<tbody>
<tr class="odd">
<td><strong>Step</strong></td>
<td><strong>Action</strong></td>
</tr>
<tr class="even">
<td>1</td>
<td>Sets counter_text to the value start_num.</td>
</tr>
<tr class="odd">
<td>2</td>
<td><p>If counter_text is greater than end_num (or less than end_num if step_num is negative), the loop ends, and the macro continues with the function after the NEXT function.</p>
<p>If counter_text is less than or equal to end_num (or greater than or equal to end_num if step_num is negative), the macro continues in the loop.</p></td>
</tr>
<tr class="even">
<td>3</td>
<td>Carries out functions up to the following NEXT function. The NEXT function must be below the FOR function and in the same column.</td>
</tr>
<tr class="odd">
<td>4</td>
<td>Adds step_num to the loop counter.</td>
</tr>
<tr class="even">
<td>5</td>
<td>Returns to the FOR function and proceeds as described in step 2.</td>
</tr>
</tbody>
</table>
<p> </p>
<ul>
<li><blockquote>
<p>You can interrupt a FOR-NEXT loop by using the BREAK function.</p>
</blockquote></li>
</ul>
<blockquote>
<p> </p>
</blockquote>
<p><strong>Example</strong></p>
<p>The following macro starts a FOR-NEXT loop that is executed once for every open window:</p>
<p>FOR("Counter", 1, COLUMNS(WINDOWS()))</p>
<p><strong>Related Functions</strong></p>
<p><a href="break.html">BREAK</a>   Interrupts a FOR-NEXT, FOR.CELL-NEXT, or WHILE-NEXT loop</p><p><a href="for.cell.html">FOR.CELL</a>   Starts a FOR.CELL-NEXT loop</p><p><a href="next.html">NEXT</a>   Ends a FOR-NEXT, FOR.CELL-NEXT, or WHILE-NEXT loop</p><p><a href="while.html">WHILE</a>   Starts a WHILE-NEXT loop</p>
</body>
</html>
