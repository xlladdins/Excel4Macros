<html>
<head>
<title>consolidate</title>
<link rel="stylesheet" href="../macros.css">
</head>
<body>
<h1 id="consolidate">CONSOLIDATE macro</h1>
<p>Equivalent to clicking the Consolidate command on the Data menu. Consolidates data from multiple ranges on multiple worksheets into a single range on a single worksheet.</p>
<p><strong>Syntax</strong></p>
<p><strong>CONSOLIDATE</strong>(source_refs, function_num, top_row, left_col, create_links)</p>
<p><strong>CONSOLIDATE</strong>?(source_refs, function_num, top_row, left_col, create_links)</p>
<p>Source_refs    are references to areas that contain data to be consolidated on the destination worksheet. Source_refs must be in text form and include the full path of the file and the cell reference or named ranges in the workbook to be consolidated. Source_refs are usually external references and must be given as an array, for example: {"SHEET1!IncomeOne", "SHEET2!IncomeTwo"}.</p>
<p>To add or delete source_refs from an existing consolidation on a worksheet, reuse the CONSOLIDATE function, specifying the new source_refs.</p>
<p>Function_num    is a number from 1 to 11 that specifies one of the 11 functions you can use to consolidate data. If function_num is omitted, the SUM function, number 9, is used. The functions and their corresponding numbers are listed in the following table.</p>
<table>
<tbody>
<tr class="odd">
<td><strong>Function_num</strong></td>
<td><strong>Function</strong></td>
</tr>
<tr class="even">
<td>1</td>
<td>AVERAGE</td>
</tr>
<tr class="odd">
<td>2</td>
<td>COUNT</td>
</tr>
<tr class="even">
<td>3</td>
<td>COUNTA</td>
</tr>
<tr class="odd">
<td>4</td>
<td>MAX</td>
</tr>
<tr class="even">
<td>5</td>
<td>MIN</td>
</tr>
<tr class="odd">
<td>6</td>
<td>PRODUCT</td>
</tr>
<tr class="even">
<td>7</td>
<td>STDEV</td>
</tr>
<tr class="odd">
<td>8</td>
<td>STDEVP</td>
</tr>
<tr class="even">
<td>9</td>
<td>SUM</td>
</tr>
<tr class="odd">
<td>10</td>
<td>VAR</td>
</tr>
<tr class="even">
<td>11</td>
<td>VARP</td>
</tr>
</tbody>
</table>
<p>The following arguments correspond to text boxes and check boxes in the Consolidate dialog box. Arguments that correspond to check boxes are logical values. If an argument is TRUE, Microsoft Excel selects the check box; if FALSE, Microsoft Excel clears the check box.</p>
<p>Top_row    corresponds to the Top Row check box. The default is FALSE.</p>
<p>Left_col    corresponds to the Left Column check box. The default is FALSE.</p>
<p>If top_row and left_col are both FALSE or omitted, the data is consolidated by position.</p>
<p>Create_links    corresponds to the Create Links To Source Data check box.</p>
<p><strong>Remarks</strong></p>
<ul>
<li><blockquote>
<p>If you use the CONSOLIDATE function with no arguments and there is a consolidation on the active worksheet, Microsoft Excel reconsolidates, using the sources, function, and position attributes used to create the existing consolidation.</p>
</blockquote></li>
<li><blockquote>
<p>If you use the CONSOLIDATE function with no arguments and there is no consolidation on the active worksheet, the function returns the #VALUE! error value.</p>
</blockquote></li>
</ul>
<blockquote>
<p> </p>
</blockquote>
<p><strong>Related Functions</strong></p>
<p><a href="change.link.html">CHANGE.LINK</a>   Changes supporting workbook links</p><p><a href="links.html">LINKS</a>   Returns the names of all linked workbooks</p><p><a href="open.links.html">OPEN.LINKS</a>   Opens specified supporting workbooks</p><p><a href="update.link.html">UPDATE.LINK</a>   Updates a link to another workbook</p>
</body>
</html>
