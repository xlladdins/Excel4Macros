<html>
<head>
<title>on.window</title>
<link rel="stylesheet" href="../macros.css">
</head>
<body>
<h1 id="on.window">ON.WINDOW macro</h1>
<p>Runs a specified macro when you switch to a particular window.</p>
<p><strong>Syntax</strong></p>
<p><strong>ON.WINDOW</strong>(window_text, macro_text)</p>
<p>Window_text    is the name of a window in the form of text. If window_text is omitted, ON.WINDOW starts the macro whenever you switch to any window, except for windows that are named in other ON.WINDOW statements.</p>
<p>Macro_text    is the name of, or an R1C1-style reference to, a macro to run when you switch to window_text. If macro_text is omitted, switching to window_text no longer runs the previously specified macro.</p>
<p><strong>Remarks</strong></p>
<ul>
<li><blockquote>
<p>A macro specified to be run by ON.WINDOW is not run when other macros switch to the window or when a command to switch to a window is received through a DDE channel. Instead, ON.WINDOW responds to a user's actions, such as clicking a window with the mouse, clicking the Copy command on the Edit menu, and so on.</p>
</blockquote></li>
<li><blockquote>
<p>If a sheet or macro sheet has an Auto_Activate or Auto_Deactivate macro defined for it, those macros will be run after the macro specified by ON.WINDOW.</p>
</blockquote></li>
</ul>
<blockquote>
<p> </p>
</blockquote>
<p><strong>Examples</strong></p>
<p>In Microsoft Excel for Windows, the following macro formula runs the macro beginning at cell R1C2 when you switch to the window MAIN.XLS:</p>
<p>ON.WINDOW("MAIN.XLS", "R1C2")</p>
<p>The following macro formula stops the macro from running when you switch to MAIN.XLS:</p>
<p>ON.WINDOW("MAIN.XLS")</p>
<p>In Microsoft Excel for the Macintosh, the following macro formula runs the macro named ShowAlert when you switch to the window MAIN WINDOW:</p>
<p>ON.WINDOW("MAIN WINDOW", "ShowAlert")</p>
<p>The following macro formula stops the macro from running when you switch to MAIN WINDOW:</p>
<p>ON.WINDOW("MAIN WINDOW")</p>
<p><strong>Related Functions</strong></p>
<p><a href="get.window.html">GET.WINDOW</a>   Returns information about a window</p><p><a href="on.key.html">ON.KEY</a>   Runs a macro when a specified key is pressed</p><p><a href="on.sheet.html">ON.SHEET</a>   Triggers a macro whenever the specified sheet is activated from another sheet</p><p><a href="windows.html">WINDOWS</a>   Returns the names of all open windows</p>
</body>
</html>
