<html>
<head>
<title>sql.error</title>
<link rel="stylesheet" type="text/css" href="macros.css"/>
</head>
<body>
<h1 id="sql.error">SQL.ERROR macro</h1>
<p>Returns detailed error information when it is called after a previous XLODBC.XLA function call has failed. If this function is not available, you must install the Microsoft ODBC add-in (XLODBC.XLA).</p>
<p><strong>Syntax</strong></p>
<p><strong>SQL.ERROR</strong>()</p>
<p>Calling SQL.ERROR returns detailed error information in a two dimensional array. Each row in the array describes exactly one error. If a function call generates multiple errors, a row will be created for each error. When SQL.ERROR is processed successfully, all SQL.ERROR information is cleared. Also, all SQL.ERROR information is automatically removed whenever an ODBC function completes successfully.</p>
<p>Each row will have exactly three fields. The information in these three fields is obtained through the SQLERROR API function call. These fields are:</p>
<ul>
<li><blockquote>
<p>A textual message describing the error.</p>
</blockquote></li>
<li><blockquote>
<p>The ODBC error class and subclass as a character string.</p>
</blockquote></li>
<li><blockquote>
<p>The data source native error code as a numeric value.</p>
</blockquote></li>
</ul>
<blockquote>
<p> </p>
</blockquote>
<p>If one or more of these fields is not available for the type of error that was encountered, the field will be left blank. For more information on the meaning of these three fields, refer to Chapter 24, "ODBC Function Reference", in the Microsoft Open Database Connectivity Programmer's Reference for the SQLError API function. See also Appendix A, "ODBC Error Codes" in the same manual.</p>
<p><strong>Remarks</strong></p>
<ul>
<li><blockquote>
<p>SQL.ERROR cannot provide information on Excel errors.</p>
</blockquote></li>
<li><blockquote>
<p>If no error information is available when SQL.ERROR is called, then it well return the error value #N/A but does not post any error information to SQL.ERROR.</p>
</blockquote></li>
<li><blockquote>
<p>SQL.ERROR stores and returns error information by processing SQL.ERROR (in the ODBC API reference) in a loop until SQL_NO_DATA_FOUND is encountered. In the SQL.ERROR function, the error information is automatically defined and stored in memory whenever an XLODBC.XLA function fails. If the call is successful then SQL.ERROR will return the error information available. If SQL.ERROR fails, it will return the error value #N/A.</p>
</blockquote></li>
</ul>
<p><strong>Example</strong></p>
<p>When entered as an array formula, the following example will return error information about each argument in, for example, SQL.GET.QUERY.</p>
<p>SQL.ERROR()</p>
<p><strong>Related Functions</strong></p>
<p><a href="sql.open.html">SQL.OPEN</a>   Establishes a connection with a data source</p><p><a href="sql.exec.query.html">SQL.EXEC.QUERY</a>   Sends a query to a data source</p><p><a href="sql.bind.html">SQL.BIND</a>   Specifies storage for a result column</p><p><a href="sql.retrieve.to.file.html">SQL.RETRIEVE.TO.FILE</a>   Retrieves query results and places them in a file</p><p><a href="sql.retrieve.html">SQL.RETRIEVE</a>   Retrieves query results</p><p><a href="sql.close.html">SQL.CLOSE</a>   Closes a data source connection</p>
</body>
</html>
