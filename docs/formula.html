<html>
<head>
<title>formula</title>
<link rel="stylesheet" type="text/css" href="css/macros.css"/>
</head>
<body>
<h1 id="formula">FORMULA macro</h1>
<p>Enters a formula in the active cell or in a reference. There are two syntax forms of this function. Use syntax 1 to enter numbers, text, references, and formulas in a worksheet. Although syntax 1 can also be used to enter values on a macro sheet, you will not generally use FORMULA for this purpose. Use syntax 2 to enter a formula in a chart. For information about setting values on a macro sheet, see "Remarks" in the following topics.</p>
<p>Syntax 1   Enters numbers, text, references, and formulas in a worksheet</p>
<p>Syntax 2   Enters formulas in a chart</p>
<h1 id="formula-syntax-1">FORMULA Syntax 1</h1>
<p>Enters a formula in the active cell or in a reference. If the active sheet is a worksheet, using FORMULA is equivalent to entering formula_text in the cell specified by reference. Formula_text is entered just as if you typed it in the formula bar.</p>
<p>There are two syntax forms of this function. Use syntax 1 to enter numbers, text, references, and formulas in a worksheet. Although syntax 1 can also be used to enter values on a macro sheet, you will not generally use FORMULA for this purpose. Use syntax 2 to enter a formula in a chart. For information about setting values on a macro sheet, see "Remarks" later in this topic.</p>
<p><strong>Syntax</strong></p>
<p><strong>FORMULA</strong>(<strong>formula_text</strong>, reference)</p>
<p>Formula_text    can be text, a number, a reference, or a formula in the form of text, or a reference to a cell containing any of the above.</p>
<ul>
<li><blockquote>
<p>If formula_text contains references, they must be R1C1-style references, such as "=RC[1]*(1+R1C1)". If you are recording a macro when you enter a formula, Microsoft Excel converts A1-style references to R1C1-style references. For example, if you enter the formula =B2*(1+$A$1) in cell C2 while recording, Microsoft Excel records that action as =FORMULA("=RC[-1]*(1+R1C1)").</p>
</blockquote></li>
<li><blockquote>
<p>If formula_text is a formula, the formula is entered. Text arguments must be surrounded by double sets of quotation marks. For example, to enter the formula =IF($A$1="Hello World", 1, 0) in the active cell with the FORMULA function, you would use the formula FORMULA("=IF(R1C1=""Hello World"", 1, 0)")</p>
</blockquote></li>
<li><blockquote>
<p>If formula_text is a number, text, or logical value, the value is entered as a constant.</p>
</blockquote></li>
</ul>
<p>Reference    specifies where formula_text is to be entered. It can be a reference to a cell in the active workbook or an external reference to a workbook. If reference is omitted, formula_text is entered in the active cell.</p>
<p><strong>Remarks</strong></p>
<p>Consider the following guidelines as you choose a function to set values on a worksheet or macro sheet:</p>
<ul>
<li><blockquote>
<p>Use FORMULA to enter formulas and change values in a worksheet cell.</p>
</blockquote></li>
<li><blockquote>
<p>SET.VALUE changes values on the macro sheet. Use SET.VALUE to assign initial values to a reference and to store values during the calculation of the macro.</p>
</blockquote></li>
<li><blockquote>
<p>SET.NAME creates names on the macro sheet. Use SET.NAME to create a name and immediately assign a value to the name.</p>
</blockquote></li>
</ul>
<blockquote>
<p> </p>
</blockquote>
<p><strong>Examples</strong></p>
<p>If the active sheet is a worksheet, the following macro formula enters the number constant 523 in the active cell:</p>
<p>FORMULA(523)</p>
<p>If the active sheet is a worksheet, the following macro formula enters the result of the INPUT function in cell A5:</p>
<p>FORMULA(INPUT("Enter a formula:", 0), !$A$5)</p>
<p>If you're using R1C1-style references and the active sheet is a worksheet, the following macro formula enters the formula =RC[-1]*(1+R1C1) in the active cell:</p>
<p>FORMULA("=RC[-1]*(1+R1C1)")</p>
<p>If the active sheet is a worksheet, the following macro formulas enter the number 1000 in the cell two rows down and three columns right from the active cell. The R1C1-style formula is shorter, but the OFFSET method may provide faster performance in larger macro sheets.</p>
<p>FORMULA(1000, OFFSET(ACTIVE.CELL(), 2, 3))</p>
<p>FORMULA(1000, "R[2]C[3]")</p>
<p>The following macro formula enters the phrase "Year to Date" in cell B4 on the sheet named SALES 1993:</p>
<p>FORMULA("Year to Date", 'SALES 1993'!B4)</p>
<p><strong>Related Functions</strong></p>
<p><a href="formula.array.html">FORMULA.ARRAY</a>   Enters an array</p><p><a href="formula.fill.html">FORMULA.FILL</a>   Enters a formula in the specified range</p><p><a href="set.value.html">SET.VALUE</a>   Sets the value of a cell on a macro sheet</p><p><a href="formula.html">FORMULA</a> Syntax 2   Enters formulas in a chart</p><h1 id="formula-syntax-2">FORMULA Syntax 2</h1>
<p>Enters a text label or SERIES formula in a chart. To enter formulas on a worksheet or macro sheet, use syntax 1 of this function.</p>
<p><strong>Syntax</strong></p>
<p><strong>FORMULA</strong>(<strong>formula_text</strong>)</p>
<p>Formula_text    is the text label or SERIES formula you want to enter into the chart.</p>
<table>
<tbody>
<tr class="odd">
<td><strong>If</strong></td>
<td><strong>Then</strong></td>
</tr>
<tr class="even">
<td>Formula_text can be treated as a text label and the current selection is a text label</td>
<td>The selected text label is replaced with formula_text.</td>
</tr>
<tr class="odd">
<td>Formula_text can be treated as a text label and there is no current selection or the current selection is not a text label</td>
<td>Formula_text creates a new unattached text label.</td>
</tr>
<tr class="even">
<td>Formula_text can be treated as a SERIES formula and the current selection is a SERIES formula</td>
<td>The selected SERIES formula is replaced with formula_text.</td>
</tr>
<tr class="odd">
<td>Formula_text can be treated as a SERIES formula and the current selection is not a SERIES formula</td>
<td>Formula_text creates a new SERIES formula.</td>
</tr>
</tbody>
</table>
<p><strong>Remarks</strong></p>
<p>You would normally use the EDIT.SERIES function to create or edit a chart series. For more information, see EDIT.SERIES.</p>
<p><strong>Example</strong></p>
<p>The following macro formula enters a SERIES formula on the chart. If the current selection is a SERIES formula, it is replaced:</p>
<p>FORMULA("=SERIES(""Title"", , {1, 2, 3}, 1)")</p>
<p><strong>Related Functions</strong></p>
<p><a href="edit.series.html">EDIT.SERIES</a>   Creates or changes a chart series</p><p>FORMULA, Syntax 1   Enters numbers, text, references, and formulas in a worksheet</p>

</body>
</html>
